{{ $featured_image := partials.Include "func/GetFeaturedImage.html" . }}
{{ if $featured_image }}
  {{/* Try to find a Hugo resource for the featured image (page bundle or assets). If found we'll generate responsive variants. */}}
  {{ $trimmed := strings.TrimPrefix $featured_image "/" }}
  {{ $imgRes := resources.Get $trimmed }}
  {{ $featured_image_class := site.Params.featured_image_class | compare.Default "cover bg-center" }}
  {{ if $imgRes }}
    {{/* Generate three sizes and a srcset */}}
    {{ $large := $imgRes.Fit "1920x800" }}
    {{ $medium := $imgRes.Fit "1200x600" }}
    {{ $small := $imgRes.Fit "800x400" }}
    {{ $srcset := printf "%s 1920w, %s 1200w, %s 800w" $large.RelPermalink $medium.RelPermalink $small.RelPermalink }}
    <header class="{{ $featured_image_class }}" style="min-height:50vh; position:relative;">
      <img src="{{ $large.RelPermalink }}" srcset="{{ $srcset }}" sizes="(min-width:1200px) 1920px, 100vw" alt="" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;object-position:center;z-index:0;" />
      {{ $cover_dimming_class := site.Params.cover_dimming_class | compare.Default "bg-black-60" }}
      <div style="position:relative;z-index:1;" class="{{ $cover_dimming_class }}">
        {{ partials.Include "site-navigation.html" .}}
        <div class="tc-l pv4 pv6-l ph3 ph4-ns">
          <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
            {{ .Title | compare.Default .Site.Title }}
          </h1>
          {{ with .Params.description }}
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center mt3">
              {{ . }}
            </h2>
          {{ end }}
        </div>
      </div>
    </header>
  {{ else }}
    {{/* Fallback to original background-image approach for static images or remote URLs */}}
    {{ $featured_image_class := site.Params.featured_image_class | compare.Default "cover bg-center" }}
    <header class="{{ $featured_image_class }}" style="background-image: url('{{ $featured_image }}'); min-height:50vh;">
      {{ $cover_dimming_class := site.Params.cover_dimming_class | compare.Default "bg-black-60" }}
      <div class="{{ $cover_dimming_class }}">
        {{ partials.Include "site-navigation.html" .}}
        <div class="tc-l pv4 pv6-l ph3 ph4-ns">
          <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
            {{ .Title | compare.Default .Site.Title }}
          </h1>
          {{ with .Params.description }}
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center mt3">
              {{ . }}
            </h2>
          {{ end }}
        </div>
      </div>
    </header>
  {{ end }}
{{ else }}
  <header>
    <div class="pb3-m pb6-l {{ .Site.Params.background_color_class | compare.Default "bg-black" }}">
      {{ partials.Include "site-navigation.html" . }}
      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          {{ .Title | compare.Default .Site.Title }}
        </h1>
        {{ with .Params.description }}
          <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
            {{ . }}
          </h2>
        {{ end }}
      </div>
    </div>
  </header>
{{ end }}